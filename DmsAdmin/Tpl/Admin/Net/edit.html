<script>
function searchUser(e){
    var num = $('#userid',navTab.getCurrentPanel()).val();
	$.ajax({
		data : {'num':num},
        url : "{:U('Net/searchUser')}",
        type : 'POST',
        dataType : 'json',
        global:false,
        success : function (data){
        	if(data.status==1){
        		$('#u_name',navTab.getCurrentPanel()).text(data.userinfo['姓名']);
        		$('#u_status',navTab.getCurrentPanel()).text(data.userinfo['状态']);
                $('#fir_tr',navTab.getCurrentPanel()).nextAll('tr').remove();
                var showstr="<tr><td align='right' width='100'>注册日期:</td><td align='left' width='200' colspan='2'>"+data.userinfo['注册日期']+"</td><td align='right' width='100'>&nbsp;</td><td align='right' width='100'>审核日期:</td><td align='left' width='200'>"+data.userinfo['审核日期']+"</td></tr>";
                
                for(netkey in data.userinfo['netlist']){
                    showstr+="<tr>";
                    showstr+="<td align='right'>"+data.userinfo['netlist'][netkey]+"人编号:</td><td align='left'>"+data[netkey][netkey+'编号']+"</td><td align='right'>"+data.userinfo['netlist'][netkey]+"人姓名:</td><td align='left'>"+data[netkey][netkey+'姓名']+"</td><td align='right'>新"+data.userinfo['netlist'][netkey]+"人编号:</td><td style='text-align:left'><input class='textInput' value='"+data[netkey][netkey+'编号']+"' type='text' name='"+netkey+"_上级编号'/>";
                    if(data[netkey][netkey+"pos"]!=undefined){
                        showstr+=data[netkey][netkey+"pos"];
                    }
                    showstr+="</td></tr>";
                }
        		$('#fir_tr',navTab.getCurrentPanel()).after(showstr);
        	}else{
        		$('#u_name',navTab.getCurrentPanel()).text(data.userinfo['姓名']);
        		$('#u_status',navTab.getCurrentPanel()).text(data.userinfo['状态']);
        		$('#fir_tr',navTab.getCurrentPanel()).nextAll('tr').remove();
        	}
		}
	})
}
</script>

<form action="__URL__/editSave" method="post" class="pageForm required-validate" onsubmit="return validateCallback(this)">
<input type="hidden" name="uid" value="{$userInfo.编号}" />
<table bordercolor="#eeeeee" border="1" style="border-collapse:collapse;" >
<tr>
	<th colspan="6" align="center" style="padding:10px">网体数据修改确认</th>
</tr>
<tr id='fir_tr'>
	<td align="right" width="100">{$name}编号:</td>
	<td align="left" width="100"><input type="text" name="uid" id="userid" value='' onkeyup="searchUser(this)" onmouseout="searchUser(this)" onmouseover="searchUser(this)" oninput="searchUser(this)"/></td>
	
	<td align="right" width="100">{$name}姓名:</td>
	<td align="left" width="100" id='u_name'></td>
	
	<td align="right" width="100">{$name}状态:</td>
	<td align="left" width="200" id='u_status'></td>
</tr>
</table>
	<div class="buttonActive" style="margin-left:330px;">
          <div class="buttonContent" >
            <button type="submit" onclick="return confirm('确定修改?')" >确定修改</button>
          </div>
      </div>
</form>
<php>
/**
* 获取会员姓名
*/
function getUserInfo($id)
{
	$model			= M('会员');
	$where['编号']	= $id;
	$name			= $model->where($where)->getField('姓名');
	return empty($name)?'暂无':$name;
}
</php>
